{% extends "base.html" %}

{% block content %}
<div class="max-w-6xl mx-auto">
    
    <form id="mainForm" class="space-y-6">

        <div id="response-container"></div>
        
        <!-- Se√ß√£o 1: Upload de Arquivos -->
        <div class="bg-white rounded-lg shadow-md p-6">
            <h2 class="text-xl font-semibold mb-4 text-gray-800">1. Sele√ß√£o de Arquivos</h2>
            <div class="mb-4">
                <label class="block text-sm font-medium text-gray-700 mb-2">
                    Arquivos HTML (m√°ximo 15)
                </label>
                <input 
                    type="file" 
                    name="files" 
                    id="fileInput" 
                    multiple 
                    accept=".html"
                    class="block w-full text-sm text-gray-500
                        file:mr-4 file:py-2 file:px-4
                        file:rounded-md file:border-0
                        file:text-sm file:font-semibold
                        file:bg-blue-50 file:text-blue-700
                        hover:file:bg-blue-100"
                    hx-post="/api/upload"
                    hx-target="#filesContainer"
                    hx-trigger="change"
                    hx-indicator="#upload-spinner"
                    hx-encoding="multipart/form-data"
                    required
                >
            </div>
            
            <div id="filesList" class="space-y-2">
                <div class="flex items-center space-x-2">
                    <h3 class="text-sm font-medium text-gray-700">Arquivos selecionados:</h3>
                    <div id="upload-spinner" class="htmx-indicator spinner"></div>
                </div>
                <div id="filesContainer" class="space-y-2">
                    <p class="text-sm text-gray-500">Nenhum arquivo selecionado</p>
                </div>
            </div>
        </div>
        
        <!-- Se√ß√£o 2: Configura√ß√£o de Estilo -->
        <div class="bg-white rounded-lg shadow-md p-6">
            <h2 class="text-xl font-semibold mb-4 text-gray-800">2. Configura√ß√£o de Estilo</h2>
            <div class="grid grid-cols-1 md:grid-cols-3 gap-4">
                <div>
                    <label class="block text-sm font-medium text-gray-700 mb-1">Estilo Musical</label>
                    <input type="text" name="estilo" id="estilo" placeholder="Ex: funk brasileiro" required 
                           class="w-full px-3 py-2 border border-gray-300 rounded-md focus:ring-2 focus:ring-blue-500 focus:border-transparent">
                </div>
                <div>
                    <label class="block text-sm font-medium text-gray-700 mb-1">ID Estilo (2-3 letras)</label>
                    <input type="text" name="id_estilo" id="id_estilo" placeholder="Ex: fk" required minlength="2" maxlength="3" 
                           class="w-full px-3 py-2 border border-gray-300 rounded-md focus:ring-2 focus:ring-blue-500 focus:border-transparent">
                </div>
                <div>
                    <label class="block text-sm font-medium text-gray-700 mb-1">Radical</label>
                    <input type="text" name="radical" id="radical" placeholder="Ex: dConst" required 
                           class="w-full px-3 py-2 border border-gray-300 rounded-md focus:ring-2 focus:ring-blue-500 focus:border-transparent">
                </div>
            </div>
        </div>
        
        <!-- Se√ß√£o 3: Configura√ß√£o de Modelos -->
		<div class="bg-white rounded-lg shadow-md p-6">
			<h2 class="text-xl font-semibold mb-4 text-gray-800">3. Configura√ß√£o de Modelos</h2>
			
			<div class="mb-6">
				<label class="block text-sm font-medium text-gray-700 mb-2">N√∫mero de Ciclos</label>
				<select name="num_ciclos" id="numCiclosSelect" 
						class="px-3 py-2 border border-gray-300 rounded-md focus:ring-2 focus:ring-blue-500">
					<option value="1" selected>1 Ciclo</option>
					<option value="2">2 Ciclos</option>
					<option value="3">3 Ciclos</option>
				</select>
			</div>
            
            <!-- Ciclos -->
            <div class="space-y-6">
                {% for ciclo in [1, 2, 3] %}
                <div id="ciclo{{ ciclo }}" class="border border-gray-200 rounded-lg p-5 {% if ciclo > 1 %}hidden{% endif %}">
                    <h3 class="font-semibold text-lg mb-4 text-gray-800 border-b pb-2">Ciclo {{ ciclo }}</h3>
                    
                    <!-- Grid de Agentes -->
                    <div class="grid grid-cols-1 lg:grid-cols-2 gap-4">
                        
                        <!-- Compositor -->
                        <div class="border-l-4 border-blue-500 pl-4 bg-blue-50 p-3 rounded-r">
                            <h4 class="font-semibold mb-2 text-blue-900">üéµ Compositor</h4>
                            <div class="space-y-2">
                                <div>
                                    <label class="text-xs text-gray-600">Prim√°rio</label>
                                    <select name="ciclo_{{ciclo}}_compositor_primario" required
                                            class="w-full px-2 py-1.5 text-sm border border-gray-300 rounded">
                                        <option value="claude-sonnet-4-5">Claude Sonnet 4.5 ‚≠ê</option>
                                        <option value="claude-opus-4-1">Claude Opus 4.1</option>
                                        <option value="gpt-5">GPT-5</option>
                                        <option value="gemini-2.5-pro">Gemini 2.5 Pro</option>
                                        <option value="gemini-2.5-flash">Gemini 2.5 Flash</option>
                                        <option value="deepseek-chat">DeepSeek Chat üí∞</option>
                                        <option value="deepseek-reasoner">DeepSeek Reasoner</option>
                                    </select>
                                </div>
                                <div>
                                    <label class="text-xs text-gray-600">Fallback</label>
                                    <select name="ciclo_{{ciclo}}_compositor_fallback" required
                                            class="w-full px-2 py-1.5 text-sm border border-gray-300 rounded">
									    <option value="deepseek-reasoner">DeepSeek Reasoner</option>
                                        <option value="gpt-5">GPT-5</option>
                                        <option value="claude-sonnet-4-5">Claude Sonnet 4.5</option>
                                        <option value="gemini-2.5-pro">Gemini 2.5 Pro</option>
                                        <option value="deepseek-chat">DeepSeek Chat</option>
                                    </select>
                                </div>
                            </div>
                        </div>

                        <!-- Revisor Jur√≠dico -->
                        <div class="border-l-4 border-red-500 pl-4 bg-red-50 p-3 rounded-r">
                            <h4 class="font-semibold mb-2 text-red-900">‚öñÔ∏è Revisor Jur√≠dico</h4>
                            <div class="space-y-2">
                                <div>
                                    <label class="text-xs text-gray-600">Prim√°rio</label>
                                    <select name="ciclo_{{ciclo}}_revisor_juridico_primario" required
                                            class="w-full px-2 py-1.5 text-sm border border-gray-300 rounded">
										<option value="gemini-2.5-pro">Gemini 2.5 Pro</option>
                                        <option value="claude-opus-4-1">Claude Opus 4.1 ‚≠ê</option>
                                        <option value="claude-sonnet-4-5">Claude Sonnet 4.5</option>
                                        <option value="gpt-5">GPT-5</option>
                                        <option value="gemini-2.5-flash">Gemini 2.5 Flash</option>
                                        <option value="deepseek-chat">DeepSeek Chat</option>
                                        <option value="deepseek-reasoner">DeepSeek Reasoner</option>
                                    </select>
                                </div>
                                <div>
                                    <label class="text-xs text-gray-600">Fallback</label>
                                    <select name="ciclo_{{ciclo}}_revisor_juridico_fallback" required
                                            class="w-full px-2 py-1.5 text-sm border border-gray-300 rounded">
										<option value="deepseek-reasoner">DeepSeek Reasoner</option>
                                        <option value="gpt-5">GPT-5</option>
                                        <option value="claude-sonnet-4-5">Claude Sonnet 4.5</option>
                                        <option value="gemini-2.5-pro">Gemini 2.5 Pro</option>
                                        <option value="deepseek-chat">DeepSeek Chat</option>
									</select>
                                </div>
                            </div>
                        </div>

                        <!-- Ajustador Jur√≠dico -->
                        <div class="border-l-4 border-orange-500 pl-4 bg-orange-50 p-3 rounded-r">
                            <h4 class="font-semibold mb-2 text-orange-900">üîß Ajustador Jur√≠dico</h4>
                            <div class="space-y-2">
                                <div>
                                    <label class="text-xs text-gray-600">Prim√°rio</label>
                                    <select name="ciclo_{{ciclo}}_ajustador_juridico_primario" required
                                            class="w-full px-2 py-1.5 text-sm border border-gray-300 rounded">
										<option value="gemini-2.5-pro">Gemini 2.5 Pro</option>
                                        <option value="claude-sonnet-4-5">Claude Sonnet 4.5 ‚≠ê</option>
                                        <option value="claude-opus-4-1">Claude Opus 4.1</option>
                                        <option value="gpt-5">GPT-5</option>
                                        <option value="gemini-2.5-flash">Gemini 2.5 Flash</option>
                                        <option value="deepseek-chat">DeepSeek Chat</option>
                                        <option value="deepseek-reasoner">DeepSeek Reasoner</option>
                                    </select>
                                </div>
                                <div>
                                    <label class="text-xs text-gray-600">Fallback</label>
                                    <select name="ciclo_{{ciclo}}_ajustador_juridico_fallback" required
                                            class="w-full px-2 py-1.5 text-sm border border-gray-300 rounded">
										<option value="deepseek-reasoner">DeepSeek Reasoner</option>
                                        <option value="gpt-5">GPT-5</option>
                                        <option value="claude-sonnet-4-5">Claude Sonnet 4.5</option>
                                        <option value="gemini-2.5-flash">Gemini 2.5 Flash</option>
										<option value="gemini-2.5-pro">Gemini 2.5 Pro</option>
                                        <option value="deepseek-chat">DeepSeek Chat</option>
									</select>
                                </div>
                            </div>
                        </div>

                        <!-- Revisor Lingu√≠stico -->
                        <div class="border-l-4 border-green-500 pl-4 bg-green-50 p-3 rounded-r">
                            <h4 class="font-semibold mb-2 text-green-900">üìù Revisor Lingu√≠stico</h4>
                            <div class="space-y-2">
                                <div>
                                    <label class="text-xs text-gray-600">Prim√°rio</label>
                                    <select name="ciclo_{{ciclo}}_revisor_linguistico_primario" required
                                            class="w-full px-2 py-1.5 text-sm border border-gray-300 rounded">
                                        <option value="gemini-2.5-pro">Gemini 2.5 Pro ‚≠ê</option>
                                        <option value="claude-sonnet-4-5">Claude Sonnet 4.5</option>
                                        <option value="claude-opus-4-1">Claude Opus 4.1</option>
                                        <option value="gpt-5">GPT-5</option>
                                        <option value="gemini-2.5-flash">Gemini 2.5 Flash</option>
                                        <option value="deepseek-chat">DeepSeek Chat</option>
                                        <option value="deepseek-reasoner">DeepSeek Reasoner</option>
                                    </select>
                                </div>
                                <div>
                                    <label class="text-xs text-gray-600">Fallback</label>
                                    <select name="ciclo_{{ciclo}}_revisor_linguistico_fallback" required
                                            class="w-full px-2 py-1.5 text-sm border border-gray-300 rounded">
										<option value="deepseek-reasoner">DeepSeek Reasoner</option>
                                        <option value="gpt-5">GPT-5</option>
                                        <option value="gemini-2.5-flash">Gemini 2.5 Flash</option>
                                        <option value="deepseek-chat">DeepSeek Chat</option>
                                        <option value="claude-sonnet-4-5">Claude Sonnet 4.5</option>
										<option value="gemini-2.5-pro">Gemini 2.5 Pro</option>
                                    </select>
                                </div>
                            </div>
                        </div>

                        <!-- Ajustador Lingu√≠stico -->
                        <div class="border-l-4 border-purple-500 pl-4 bg-purple-50 p-3 rounded-r">
                            <h4 class="font-semibold mb-2 text-purple-900">‚ú® Ajustador Lingu√≠stico</h4>
                            <div class="space-y-2">
                                <div>
                                    <label class="text-xs text-gray-600">Prim√°rio</label>
                                    <select name="ciclo_{{ciclo}}_ajustador_linguistico_primario" required
                                            class="w-full px-2 py-1.5 text-sm border border-gray-300 rounded">
										<option value="gemini-2.5-pro">Gemini 2.5 Pro</option>
                                        <option value="gemini-2.5-flash">Gemini 2.5 Flash ‚≠ê</option>
                                        <option value="claude-sonnet-4-5">Claude Sonnet 4.5</option>
                                        <option value="claude-opus-4-1">Claude Opus 4.1</option>
                                        <option value="gpt-5">GPT-5</option>
                                        <option value="deepseek-chat">DeepSeek Chat</option>
                                        <option value="deepseek-reasoner">DeepSeek Reasoner</option>
                                    </select>
                                </div>
                                <div>
                                    <label class="text-xs text-gray-600">Fallback</label>
                                    <select name="ciclo_{{ciclo}}_ajustador_linguistico_fallback" required
                                            class="w-full px-2 py-1.5 text-sm border border-gray-300 rounded">
										<option value="deepseek-reasoner">DeepSeek Reasoner</option>
                                        <option value="gpt-5">GPT-5</option>
                                        <option value="gemini-2.5-flash">Gemini 2.5 Flash</option>
										<option value="gemini-2.5-pro">Gemini 2.5 Pro</option>
                                        <option value="deepseek-chat">DeepSeek Chat</option>
                                        <option value="claude-sonnet-4-5">Claude Sonnet 4.5</option>
									</select>
                                </div>
                            </div>
                        </div>

                    </div>
                </div>
                {% endfor %}
            </div>

            <!-- Legenda -->
            <div class="mt-4 p-3 bg-gray-50 rounded border border-gray-200">
                <p class="text-xs text-gray-600">
                    <strong>Legenda:</strong> 
                    ‚≠ê = Recomendado | 
                    üí∞ = Mais barato (~$0.001/1K tokens)
                </p>
            </div>
        </div>

        <!-- Bot√£o de Envio -->
        <div class="text-center">
            <button 
                type="submit"
                id="submitBtn"
                class="px-8 py-3 bg-blue-600 text-white font-semibold rounded-lg hover:bg-blue-700 
                       disabled:bg-gray-400 transition-colors shadow-lg hover:shadow-xl"
            >
                üöÄ Iniciar Processamento
            </button>
        </div>
    </form>
</div>
{% endblock %}

{% block extra_scripts %}
<script src="/static/js/app.js"></script>
{% endblock %}